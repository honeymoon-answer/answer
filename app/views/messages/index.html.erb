<script type="text/x-template" id="js-index__left__messages__table__template">
  <table class="table table-sm">
    <thead>
      <tr>
        <th v-for="key in columns"
          @click="sortBy(key)"
          :class="{ active: sortKey == key }">
          {{ key | capitalize }}
          <span class="arrow" :class="sortOrders[key] > 0 ? 'asc' : 'dsc'">
          </span>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="entry in filteredData">
        <td v-for="key in columns">
          {{entry[key]}}
        </td>
      </tr>
    </tbody>
  </table>
</script>

<div class="row">
  <div class="col">

    <div id="js-index__left__messages__table">
      <form class="form-inline">
          <div class="form-group mr-3 mb-3">
            <a class="btn btn-primary" href="/messages/create">Create Message</a>
          </div>
          <div class="form-group mb-3">
            <div class="input-group">
              <div class="input-group-addon">Search</div>
              <input type="text" class="form-control" v-model="messagesTableSearchQuery" placeholder="search words">
            </div>
          </div>
      </form>
      <messages-table
        :data="messages"
        :columns="messagesTableColumns"
        :filter-key="messagesTableSearchQuery">
      </messages-table>
    </div>
  </div>
  <div class="col">

    <div id="accordion" role="tablist" aria-multiselectable="true">
      <div class="card">
        <div class="card-header" role="tab" id="headingOne">
          <h5 class="mb-0">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Graphs
            </a>
          </h5>
        </div>
        <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne">
          <div class="card-block">
            TODO: グラフ
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header" role="tab" id="headingTwo">
          <h5 class="mb-0">
            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              Unanswered users
            </a>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="card-block">
            <table>
              <tr><td>@takumakume</td></tr>
            </table>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header" role="tab" id="headingThree">
          <h5 class="mb-0">
            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
              Answered users
            </a>
          </h5>
        </div>
        <div id="collapseThree" class="collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="card-block">
            <table class="table table-sm table-hover">
              <tr>
                <td>@pyama</td>
                <td>不参加</td>
              </tr>
              <tr>
                <td>@baachii</td>
                <td>参加</td>
              </tr>
              <tr>
                <td>@tnmt</td>
                <td>参加</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<%= stylesheet_link_tag "messages" %>
<%= javascript_include_tag "messages/index" %>
